# Вычислятор #
Требуется сделать приложение, которое принимает на вход следующий список инструкций:

<ul>
  <li> calc - вычислить арифметическую операцию над двумя сущностями и сохранить результат.</li>
  <li> print - вывести значение указанной переменной. </li>

</ul> 

### Основной функционал ###
Основная логика обработки инструкций реализована в файле internal/service/calculator.go.

Сервис получает список инструкций двух типов:
<ul>
   <li>  calc — вычисление выражения </li>

   <li>  print — вывод значения переменной </li>
</ul> 
Каждая инструкция представлена структурой instruction, содержащей поля:
<ul>
  <li> type: тип инструкции </li>

  <li> var: имя переменной </li>

  <li> op: операция </li>

  <li>  left, right: операнды, которые могут быть числами или ссылками на переменные </li>
</ul> 
Вычисления обрабатываются поэтапно:
<ul>
  <li> Сначала строится граф зависимостей между переменными </li>

  <li> Затем производится пошаговое вычисление значений с учётом зависимостей </li>

  <li> Инструкция print добавляется в финальный вывод только после расчёта нужной переменной </li>
</ul> 

### Архитектура ###

```
├── api/                   # Протоколы взаимодействия
│   └── proto/             # gRPC-схемы
│       ├── calc.proto
│       ├── calc.pb.go
│       └── calc_grpc.pb.go
│
├── build/                 # Папка файлов для развертывания
│   ├── Dockerfile         # Сборка образа приложения
│   └── docker-compose.yml # Подъём контейнеров
│
├── docs/                  # Swagger-документация
│   ├── docs.go            # Генерируемый файл для swag
│   ├── swagger.json
│   └── swagger.yaml
│
├── internal/              # Основная бизнес-логика
│   ├── handler/           # HTTP и gRPC обработчики
│   │   ├── handler.go
│   │   └── grpc_server.go
│   │
│   ├── model/             # Модели данных 
│   │   └── instructions.go
│   │
│   └── service/           # Логика выполнения инструкций
│       ├── calculator.go
│       └── ev1_test.go    # Unit-тесты
│
├── main/                  # Точка входа в приложение
│   └── main.go
│
├── go.mod                 # Зависимости проекта
├── go.sum
└── README.md 
```
### Примеры запроса и ответа  ###
Для выполнения инструкций через HTTP был отправлен следующий запрос в формате json:

```
[
  { "type": "calc", "op": "+", "var": "x", "left": 1, "right": 2 },
  { "type": "print", "var": "x" }
]
```
В ответ на это был получен следующий результат:

```
{
  "items": [
    { "var": "x", "value": 3 }
  ]
}
```

### Тестирование ###
<ul>
  <li> Для тестирования HTTP был отправлен запрос с помощью приложения Postman.</li>
  <li> Для тестирования swagger потребовалось зайти по следующей ссылке: `http://localhost:8080/swagger/index.html`</li>
  <li> Для тестирвоания gRPC был создан json-файл и отправлен с помощью grpcurl, в ответ был получен валидный результат </li>
  <li> Также были выполни тесты с помощью unit-test. Покрытие тестов составило: 67%  </li>
</ul> 

